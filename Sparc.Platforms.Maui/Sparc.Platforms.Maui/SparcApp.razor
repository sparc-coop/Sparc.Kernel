<SparcErrorBoundary>
		<CascadingAuthenticationState>
			<Router AppAssembly="@Startup.Assembly" AdditionalAssemblies="@AdditionalAssemblies">
				<Found Context="routeData">
					<AuthorizeRouteView RouteData="@routeData"
										DefaultLayout="MainLayout.GetType()">
						<NotAuthorized>
							@if (context.User.Identity == null)
							{
								<RedirectToLogin />
							}
							else
							{
								<p>
									You are not authorized to access
									this resource.
								</p>
							 }
						</NotAuthorized>
						<Authorizing>
							<div class="sparc-authentication">
								Logging you in...
							</div>
						</Authorizing>
					</AuthorizeRouteView>
				</Found>
				<NotFound>
					<LayoutView Layout="MainLayout.GetType()">
						<p>Sorry, there's nothing at this address.</p>
					</LayoutView>
				</NotFound>
			</Router>
		</CascadingAuthenticationState>
</SparcErrorBoundary>

@inject LayoutComponentBase MainLayout
@code {
	[Parameter] public Type Startup { get; set; }

	public System.Reflection.Assembly[] AdditionalAssemblies => MainLayout.GetType().Assembly.FullName == this.GetType().Assembly.FullName
		? new System.Reflection.Assembly[] { }
		: new[] { MainLayout.GetType().Assembly };
} 